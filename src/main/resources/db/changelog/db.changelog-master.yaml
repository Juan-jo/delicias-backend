databaseChangeLog:
  - changeSet:
      id: 27032024_01
      author: jdev
      changes:
        - sql:
            sql: >-
              create extension if not exists "uuid-ossp";
              create extension if not exists citext;

  -  changeSet:
       id: 27032024_02
       author: jdev
       changes:
         - createSequence:
               cycle: false
               dataType: INTEGER
               startValue: 1
               incrementBy: 1
               minValue: 1
               maxValue: 2147483647
               schemaName: public
               sequenceName: product_category_id_seq
         -  createTable:
              tableName: product_category
              columns:
                -  column:
                     name: id
                     type: INTEGER
                     remarks:  ID Unique, PK
                     defaultValueComputed: nextval('product_category_id_seq')
                     constraints:
                       nullable: false
                       primaryKey: true
                       primaryKeyName: pk_product_category_id
                -  column:
                     name: name
                     type: VARCHAR
                     remarks: Name
                - column:
                    name: complete_name
                    type: VARCHAR
                    remarks: Complete Name
                - column:
                    name: parent_path
                    type: VARCHAR
                    remarks: Parent path
                - column:
                    name: parent_id
                    type: INTEGER
                    remarks: Parent Category
                - column:
                    name: created_at
                    type: TIMESTAMP WITHOUT TIME ZONE
                    remarks: Created on
                - column:
                    name: updated_at
                    type: TIMESTAMP WITHOUT TIME ZONE
                    remarks: Last Updated on
                - column:
                    name: create_uid
                    type: VARCHAR
                    remarks: Created by
                - column:
                    name: write_uid
                    type: VARCHAR
                    remarks: Last Updated by
         - createIndex:
             clustered: false
             columns:
               - column:
                   descending: false
                   name: name
             indexName: product_category__name_index
             schemaName: public
             tableName: product_category
             unique: true
         - addForeignKeyConstraint:
             baseColumnNames: parent_id
             baseTableName: product_category
             constraintName: product_category_parent_id_fkey
             referencedColumnNames: id
             referencedTableName: product_category
             validate: true

  - changeSet:
      id: 27032024_03
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: product_attribute_id_seq
        - createTable:
            tableName: product_attribute
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('product_attribute_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_product_attribute_id
              - column:
                  name: name
                  type: VARCHAR
                  remarks: Attribute
              - column:
                  name: display_type
                  type: VARCHAR
                  remarks: Display Type
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by
  - changeSet:
      id: 27032024_04
      author: jdev
      changes:
        - loadData:
            columns:
              - column:
                  header: name
                  name: name
                  type: VARCHAR
              - column:
                  header: display_type
                  name: display_type
                  type: VARCHAR
            encoding: UTF-8
            file: /db/changelog/product_attribute.csv
            schemaName: public
            tableName: product_attribute

  - changeSet:
      id: 27032024_05
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: product_attribute_value_id_seq
        - createTable:
            tableName: product_attribute_value
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('product_attribute_value_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_product_attribute_value_id
              - column:
                  name: name
                  type: VARCHAR
                  remarks: Value
              - column:
                  name: attribute_id
                  type: INTEGER
                  remarks: Attribute
              - column:
                  name: default_extra_price
                  type: FLOAT8
                  remarks: Default Extra Price
              - column:
                  name: sequence
                  type: INTEGER
                  remarks: Sequence
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by
        - addForeignKeyConstraint:
            baseColumnNames: attribute_id
            baseTableName: product_attribute_value
            constraintName: product_attribute_value_attribute_id_fkey
            referencedColumnNames: id
            referencedTableName: product_attribute
            validate: true

  - changeSet:
      id: 27032024_06
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: product_template_id_seq
        - createTable:
            tableName: product_template
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('product_template_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_product_template_id
              - column:
                  name: categ_id
                  type: INTEGER
                  remarks: Category
              - column:
                  name: restaurant_id
                  type: INTEGER
                  remarks: Restaurant
              - column:
                  name: name
                  type: VARCHAR
                  remarks: Name
              - column:
                  name: description
                  type: TEXT
                  remarks: Description
              - column:
                  name: has_configurable_attributes
                  type: BOOL
                  remarks: Is a configurable product
              - column:
                  name: list_price
                  type: FLOAT8
                  remarks: Sales Price
              - column:
                  name: sales_ok
                  type: BOOL
                  remarks: Can be Sold
              - column:
                  name: active
                  type: BOOL
                  remarks: Active
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by
        - addForeignKeyConstraint:
            baseColumnNames: categ_id
            baseTableName: product_template
            constraintName: product_template_categ_id_fkey
            referencedColumnNames: id
            referencedTableName: product_category
            validate: true

  - changeSet:
      id: 27032024_07
      author: jdev
      changes:
        - createTable:
            tableName: product_attribute_product_template_rel
            columns:
              - column:
                  name: product_attribute_id
                  type: INTEGER
              - column:
                  name: product_template_id
                  type: INTEGER
        - addForeignKeyConstraint:
            baseColumnNames: product_attribute_id
            baseTableName: product_attribute_product_template_rel
            constraintName: product_attribute_product_template_rel_product_attribute_id_fkey
            referencedColumnNames: id
            referencedTableName: product_attribute
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: product_template_id
            baseTableName: product_attribute_product_template_rel
            constraintName: product_attribute_product_template_rel_product_template_id_fkey
            referencedColumnNames: id
            referencedTableName: product_template
            validate: true
        - addPrimaryKey:
            clustered: true
            columnNames: product_attribute_id, product_template_id
            constraintName: pk_product_attribute_product_template_rel
            schemaName: public
            tableName: product_attribute_product_template_rel
            validate: true

  - changeSet:
      id: 27032024_08
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: product_template_product_attribute_value_rel_id_seq
        - createTable:
            tableName: product_template_product_attribute_value_rel
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('product_template_product_attribute_value_rel_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_product_template_product_attribute_value_rel_id
              - column:
                  name: product_tmpl_id
                  type: INTEGER
                  remarks: Product Template
              - column:
                  name: product_attribute_value_id
                  type: INTEGER
                  remarks: Attribute Value
              - column:
                  name: attribute_id
                  type: INTEGER
                  remarks: Attribute
              - column:
                  name: active
                  type: BOOL
                  remarks: Active
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by
              - addForeignKeyConstraint:
                  baseColumnNames: product_tmpl_id
                  baseTableName: product_template_product_attribute_value_rel
                  constraintName: product_template_product_attribute_value_rel_product_tmpl_id_fkey
                  referencedColumnNames: id
                  referencedTableName: product_template
              - addForeignKeyConstraint:
                  baseColumnNames: product_attribute_value_id
                  baseTableName: product_template_product_attribute_value_rel
                  constraintName: product_template_product_attribute_value_rel_product_attribute_value_id_fkey
                  referencedColumnNames: id
                  referencedTableName: product_attribute_value
              - addForeignKeyConstraint:
                  baseColumnNames: attribute_id
                  baseTableName: product_template_product_attribute_value_rel
                  constraintName: product_template_product_attribute_value_rel_attribute_id_fkey
                  referencedColumnNames: id
                  referencedTableName: product_attribute

  - changeSet:
      id: 27032024_09
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: pos_order_id_seq
        - createTable:
            tableName: pos_order
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('pos_order_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_pos_order_id
              - column:
                  name: status
                  type: VARCHAR
                  remarks: Status
              - column:
                  name: notes
                  type: VARCHAR
                  remarks: Customer notes
              - column:
                  name: amount_total
                  type: FLOAT8
                  remarks: Total
              - column:
                  name: restaurant_id
                  type: INTEGER
                  remarks: Restaurant
              - column:
                  name: user_uid
                  type: UUID
                  remarks: Keycloak user ID
              - column:
                  name: delivery_uid
                  type: UUID
                  remarks: Keycloak delivery user ID
              - column:
                  name: date_order
                  type: DATE
                  remarks: Date
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by
        - createIndex:
            clustered: false
            columns:
              - column:
                  descending: false
                  name: user_uid
            indexName: pos_order__user_uid_index
            schemaName: public
            tableName: pos_order
            unique: false
        - createIndex:
            clustered: false
            columns:
              - column:
                  descending: false
                  name: restaurant_id
            indexName: pos_order__restaurant_id_index
            schemaName: public
            tableName: pos_order
            unique: false
        - createIndex:
            clustered: false
            columns:
              - column:
                  descending: false
                  name: date_order
            indexName: pos_order__date_order_index
            schemaName: public
            tableName: pos_order
            unique: false

  - changeSet:
      id: 27032024_10
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: pos_order_line_id_seq
        - createTable:
            tableName: pos_order_line
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('pos_order_line_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_pos_order_line_id
              - column:
                  name: order_id
                  type: INTEGER
                  remarks: Order Ref
              - column:
                  name: product_tmpl_id
                  type: INTEGER
                  remarks: Product template
              - column:
                  name: qty
                  type: INTEGER
                  remarks: Quantity
              - column:
                  name: price_unit
                  type: FLOAT8
                  remarks: Unit Price
              - column:
                  name: price_total
                  type: FLOAT8
                  remarks: Total
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by
        - addForeignKeyConstraint:
            baseColumnNames: order_id
            baseTableName: pos_order_line
            constraintName: pos_order_line_order_id_fkey
            referencedColumnNames: id
            referencedTableName: pos_order
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: product_tmpl_id
            baseTableName: pos_order_line
            constraintName: pos_order_line_product_tmpl_id_fkey
            referencedColumnNames: id
            referencedTableName: product_template
            validate: true

  - changeSet:
      id: 27032024_11
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: pos_order_line_product_attribute_value_rel_id_seq
        - createTable:
            tableName: pos_order_line_product_attribute_value_rel
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('pos_order_line_product_attribute_value_rel_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_pos_order_line_product_attribute_value_rel_id
              - column:
                  name: order_line_id
                  type: INTEGER
                  remarks: Order Line Ref
              - column:
                  name: product_attribute_value_id
                  type: INTEGER
                  remarks: Attribute Value
              - column:
                  name: default_extra_price
                  type: FLOAT8
                  remarks: Extra price
        - addForeignKeyConstraint:
            baseColumnNames: order_line_id
            baseTableName: pos_order_line_product_attribute_value_rel
            constraintName: pos_order_line_product_attribute_value_rel_order_line_id_fkey
            referencedColumnNames: id
            referencedTableName: pos_order_line
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: product_attribute_value_id
            baseTableName: pos_order_line_product_attribute_value_rel
            constraintName: pos_order_line_product_attribute_value_rel_product_attribute_value_id_fkey
            referencedColumnNames: id
            referencedTableName: product_attribute_value
            validate: true

  - changeSet:
      id: 27032024_12
      author: jdev
      changes:
        - addColumn:
            tableName: product_attribute
            columns:
              - column:
                  name: sequence
                  type: INTEGER

  - changeSet:
      id: 27032024_13
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: restaurant_template_id_seq
        - createTable:
            tableName: restaurant_template
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('restaurant_template_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_restaurant_template_id
              - column:
                  name: name
                  type: VARCHAR
                  remarks: Restaurant name
              - column:
                  name: description
                  type: VARCHAR
                  remarks: Restaurant description
              - column:
                  name: phone
                  type: VARCHAR(15)
                  remarks: phone
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by

  -  changeSet:
       id:  27032024_14
       author: jdev
       changes:
         -  addForeignKeyConstraint:
              baseColumnNames: restaurant_id
              baseTableName: product_template
              constraintName: product_template_restaurant_template_id_fkey
              referencedColumnNames: id
              referencedTableName: restaurant_template
              validate: true

  - changeSet:
      id: addColumn-example
      author: liquibase-docs
      changes:
        - addColumn:
            tableName: product_attribute
            columns:
              - column:
                  name: restaurant_id
                  type: INTEGER
                  remarks: Restaurant
        -  addForeignKeyConstraint:
             baseColumnNames: restaurant_id
             baseTableName: product_attribute
             constraintName: product_attribute_restaurant_template_id_fkey
             referencedColumnNames: id
             referencedTableName: restaurant_template
             validate: true

  -  changeSet:
       id:  2703202416
       author:  jdev
       changes:
         -  createView:
              encoding:  UTF-8
              replaceIfExists:  false
              schemaName:  public
              selectQuery:  select
                ptpavr.id ,
                ptpavr.product_tmpl_id,
                pav."name" as "name_attr_val" ,
                pav."sequence" as "sequence_attr_val",
                pa."name" as "name_attr",
                pa."sequence" as "sequence_attr",
                pav.default_extra_price
                from
                product_template_product_attribute_value_rel ptpavr
                join product_attribute_value pav on ptpavr.product_attribute_value_id = pav.id
                join product_attribute pa on ptpavr.attribute_id = pa.id
                order by pa."sequence" , pav."sequence"
              viewName:  product_tmpl_attr_values

  - changeSet:
      id: 2703202417
      author: jdev
      changes:
        - addColumn:
            columns:
              - column:
                  name: picture
                  type: VARCHAR
                  remarks: Image path
            tableName: product_template

  - changeSet:
      id: 27032024_18
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: pos_restaurant_kanban_id_seq
        - createTable:
            tableName: pos_restaurant_kanban
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('pos_restaurant_kanban_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_pos_restaurant_kanban_id
              - column:
                  name: order_id
                  type: INTEGER
                  remarks: Order Ref
              - column:
                  name: restaurant_id
                  type: INTEGER
                  remarks: Restaurant Ref
        - addForeignKeyConstraint:
            baseColumnNames: order_id
            baseTableName: pos_restaurant_kanban
            constraintName: pos_restaurant_kanban_pos_order_fkey
            referencedColumnNames: id
            referencedTableName: pos_order
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: restaurant_id
            baseTableName: pos_restaurant_kanban
            constraintName: pos_restaurant_kanban_restaurant_template_fkey
            referencedColumnNames: id
            referencedTableName: restaurant_template
            validate: true
        - createIndex:
            tableName: pos_restaurant_kanban
            indexName: idx_pos_restaurant_kanban_restaurant_id
            columns:
              - column:
                  name: restaurant_id
            using: hash

  - changeSet:
      id: 27032024_19
      author: jdev
      changes:
        - addColumn:
            tableName: pos_order
            columns:
              - column:
                  name: keycloak_user_id
                  type: UUID
                  remarks: Keycloak User ID
                  constraints:
                    nullable: false
        - createIndex:
            tableName: pos_order
            indexName: idx_pos_order_keycloak_user_id
            columns:
              - column:
                  name: keycloak_user_id

  - changeSet:
      id: 27032024_20
      author: jdev
      changes:
        - addColumn:
            tableName: pos_order
            columns:
              - column:
                  name: amount_subtotal
                  type: FLOAT8
                  remarks: Subtotal amount
              - column:
                  name: amount_discount
                  type: FLOAT8
                  remarks: Discount amount
              - column:
                  name: cost_service
                  type: FLOAT8
                  remarks: Cost service

  - changeSet:
      id: 27032024_21
      author: jdev
      changes:
        - addColumn:
            tableName: pos_restaurant_kanban
            columns:
              - column:
                  name: status
                  type: VARCHAR
                  remarks: Kanban Status

  - changeSet:
      id: 27032024_22
      author: jdev00000
      changes:
        - sql:
            sql: >-
              create extension if not exists postgis;

  - changeSet:
      id: 27032024_23
      author: jdev
      changes:
        - addColumn:
            tableName: restaurant_template
            columns:
              - column:
                  name: position
                  type: GEOGRAPHY(Point)
                  remarks: longitud, latitud address location

  - changeSet:
      id: 27032024_24
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: deliverers_id_seq
        - createTable:
            tableName: deliverers
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('deliverers_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_deliverers_id
              - column:
                  name: deliverer_id
                  type: UUID
                  remarks: Deliverer Keycloak User ID
                  constraints:
                    nullable: false
              - column:
                  name: status
                  type: VARCHAR(50)
                  remarks: Status
              - column:
                  name: last_position
                  type: GEOGRAPHY(Point)
                  remarks: longitud, latitud address location
                  constraints:
                    nullable: false

  - changeSet:
      id: 27032024_25
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: delivery_order_rel_id_seq
        - createTable:
            tableName: delivery_order_rel
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('delivery_order_rel_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_delivery_order_rel_id
              - column:
                  name: deliverer_id
                  type: UUID
                  remarks: Deliverer Keycloak User ID
                  constraints:
                    nullable: false
              - column:
                  name: order_id
                  type: INTEGER
                  remarks: Order ID
              - column:
                  name: last_position
                  type: GEOGRAPHY(Point)
                  remarks: longitud, latitud address location
        - addForeignKeyConstraint:
            baseColumnNames: order_id
            baseTableName: delivery_order_rel
            constraintName: delivery_order_rel_pos_order_fkey
            referencedColumnNames: id
            referencedTableName: pos_order
            validate: true
        - addUniqueConstraint:
            columnNames: order_id
            constraintName: delivery_order_rel_order_id_unique
            schemaName: public
            tableName: delivery_order_rel
            validate: true

  - changeSet:
      id: 27032024_26
      author: jdev
      changes:
        - addColumn:
            tableName: deliverers
            columns:
              - column:
                  name: destination_position
                  type: GEOGRAPHY(Point)
                  remarks: longitud, latitud when status ROAD_TO_STORE | ROAD_TO_DELIVERY

  - changeSet:
      id: 27032024_27
      author: jdev
      changes:
        - sql:
            sql: >-
              CREATE TYPE deliver_order_rel_status_type AS ENUM ('NOT_STARTED', 'ROAD_DELIVERY', 'FINISHED');
        - addColumn:
            tableName: delivery_order_rel
            columns:
              - column:
                  name: status
                  type: deliver_order_rel_status_type
                  remarks: Status

  - changeSet:
      id: 27032024_28
      author: jdev
      changes:
        - dropColumn:
            columnName: status
            tableName: deliverers
        - sql:
            sql: >-
              CREATE TYPE deliver_status_type AS ENUM ('AVAILABLE', 'ASSIGNED_ORDERS');
        - addColumn:
            tableName: deliverers
            columns:
              - column:
                  name: status
                  type: deliver_status_type
                  remarks: Status

  - changeSet:
      id: 27032024_29
      author: jdev
      changes:
        - sql:
            sql: >-
              ALTER TYPE deliver_order_rel_status_type ADD VALUE 'ROAD_TO_STORE';

  - changeSet:
      id: 27032024_30
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: user_address_id_seq
        - createTable:
            tableName: user_addresses
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('user_address_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_user_address_id
              - column:
                  name: keycloak_user_id
                  type: UUID
                  remarks: Keycloak User ID
                  constraints:
                    nullable: false
              - column:
                  name: name
                  type: VARCHAR(50)
                  remarks: Name(Home, Dpto, Work, etc..)
                  constraints:
                    nullable: false
              - column:
                  name: position
                  type: GEOGRAPHY(Point)
                  remarks: longitud, latitud address location
                  constraints:
                    nullable: false

  - changeSet:
      id: 27032024_31
      author: jdev
      changes:
        - addColumn:
            tableName: pos_order
            columns:
              - column:
                  name: user_address_id
                  type: Integer
                  remarks: User Address
        - addForeignKeyConstraint:
            baseColumnNames: user_address_id
            baseTableName: pos_order
            constraintName: pos_order_user_addresses_fkey
            referencedColumnNames: id
            referencedTableName: user_addresses
            validate: true

  - changeSet:
      id: 27032024_32
      author: jdev
      changes:
        - sql:
            sql: >-
              ALTER TABLE delivery_order_rel DROP COLUMN status;
              DROP TYPE deliver_order_rel_status_type;
              CREATE TYPE deliver_order_rel_status_type AS ENUM ('NOT_STARTED', 'ROAD_TO_STORE', 'ROAD_TO_DELIVERY', 'FINISHED');
        - addColumn:
            tableName: delivery_order_rel
            columns:
              - column:
                  name: status
                  type: deliver_order_rel_status_type
                  remarks: Status

  - changeSet:
      id: 27032024_33
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: restaurant_menu_seq
        - createTable:
            tableName: restaurant_menu
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('restaurant_menu_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_restaurant_menu_id
              - column:
                  name: name
                  type: CITEXT
                  remarks: Name menu
                  constraints:
                    nullable: false
              - column:
                  name: restaurant_id
                  type: INTEGER
                  remarks: Restaurant Ref
                  constraints:
                    nullable: false
              - column:
                  name: available
                  type: BOOL
                  defaultValueBoolean: false
                  remarks: Is available
        - addUniqueConstraint:
            columnNames: name, restaurant_id
            constraintName: restaurant_menu_name_restaurant_id_unique
            schemaName: public
            tableName: restaurant_menu
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: restaurant_id
            baseTableName: restaurant_menu
            constraintName: restaurant_menu_restaurant_template_fkey
            referencedColumnNames: id
            referencedTableName: restaurant_template
            validate: true

  - changeSet:
      id: 27032024_34
      author: jdev
      changes:
        - addColumn:
            tableName: restaurant_menu
            columns:
              - column:
                  name: products_tmpl
                  type: int[]
                  remarks: List of Id`s products template

  -  changeSet:
       id: 27032024_35
       author: jdev
       changes:
         -  createTable:
              tableName: mobile_config
              columns:
                -  column:
                     name: id
                     type: INTEGER
                     remarks: ID Unique, PK
                - column:
                    name: available_restaurants
                    type: int[]
                    remarks: List of Id`s restaurants template
                - column:
                    name: cost_service
                    type: FLOAT8
                - column:
                    name: zone_center_location
                    type: GEOGRAPHY(Point)
         - sql:
             sql: >-
               INSERT INTO mobile_config(id, cost_service, zone_center_location) VALUES(27032024, 35, 'SRID=4326;POINT (-98.410801 21.143786)'::public.geography);

  - changeSet:
      id: 27032024_36
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: restaurant_schedule_id_seq
        -  createTable:
             tableName: restaurant_schedule
             columns:
               -  column:
                    name: id
                    type: INTEGER
                    remarks: ID Unique, PK
                    defaultValueComputed: nextval('restaurant_schedule_id_seq')
                    constraints:
                      nullable: false
                      primaryKey: true
                      primaryKeyName: pk_restaurant_schedule_id
               - column:
                   name: restaurant_id
                   type: INTEGER
                   remarks: Restaurant Ref
               - column:
                   name: day_of_week
                   type: VARCHAR(10)
               - column:
                   name: start_time
                   type: TIME WITHOUT TIME ZONE
               - column:
                   name: end_time
                   type: TIME WITHOUT TIME ZONE
               - column:
                   name: available
                   type: BOOL
                   defaultValueBoolean: false
                   remarks: Is available
        - addUniqueConstraint:
            columnNames: restaurant_id, day_of_week
            constraintName: restaurant_schedule_restaurant_id_day_of_week_unique
            schemaName: public
            tableName: restaurant_schedule
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: restaurant_id
            baseTableName: restaurant_schedule
            constraintName: restaurant_schedule_restaurant_template_fkey
            referencedColumnNames: id
            referencedTableName: restaurant_template
            validate: true

  - changeSet:
      id: 27032024_37
      author: jdev
      changes:
        - addColumn:
            tableName: restaurant_menu
            columns:
              - column:
                  name: sequence
                  type: INTEGER
                  remarks: Sequence menu mobile

  - changeSet:
      id: 27032024_38
      author: jdev
      changes:
        - addColumn:
            tableName: restaurant_template
            columns:
              - column:
                  name: recommended_products_tmpl
                  type: int[]
                  remarks: Recommended ID`s products tmpl

  - changeSet:
      id: 27032024_39
      author: jdev
      changes:
        - addColumn:
            tableName: restaurant_template
            columns:
              - column:
                  name: address
                  type: VARCHAR(80)
                  remarks:
              - column:
                  name: image_cover
                  type: VARCHAR(50)
                  remarks: Cover mobile image
              - column:
                  name: image_logo
                  type: VARCHAR(50)
                  remarks: Logo mobile image

  - changeSet:
      id: 27032024_40
      author: jdev
      changes:
        - addColumn:
            tableName: user_addresses
            columns:
              - column:
                  name: type_address
                  type: VARCHAR(30)
                  remarks: Type Address - Casa, Depto, Office
              - column:
                  name: details
                  type: VARCHAR(250)
                  remarks: When is HOME, DEPTO
              - column:
                  name: company_name
                  type: VARCHAR(250)
                  remarks: When is OFFICE
              - column:
                  name: street
                  type: VARCHAR(250)
                  remarks: Street
              - column:
                  name: address
                  type: VARCHAR(250)
                  remarks: Address, country, city

  - changeSet:
      id: 27032024_41
      author: jdev
      changes:
        - addColumn:
            tableName: user_addresses
            columns:
              - column:
                  name: indications
                  type: VARCHAR(250)
                  remarks: Deliverer indications
  -  changeSet:
       id:  27032024_42
       author:  jdev
       changes:
         -  dropColumn:
              columns:
                -  column:
                     name: name
              schemaName: public
              tableName: user_addresses
  - changeSet:
      id: 27032024_43
      author: jdev
      changes:
        - addColumn:
            tableName: pos_order
            columns:
              - column:
                  name: delivery_order_rel_id
                  type: INTEGER
                  remarks: Set value when the delivery person is assigned

  - changeSet:
      id: 27032024_44
      author: jdev
      changes:
        - sql:
            endDelimiter: \nGO
            splitStatements: true
            sql: >-
              CREATE OR REPLACE FUNCTION update_orders_trigger_function()
              RETURNS TRIGGER AS $$
              BEGIN
                UPDATE pos_order
                SET   delivery_order_rel_id = NEW.id,
                      delivery_uid = NEW.deliverer_id
                WHERE id = NEW.order_id;
                RETURN NEW;
              END; $$ LANGUAGE plpgsql;

  - changeSet:
      id: 27032024_45
      author: jdev
      changes:
        - sql:
            endDelimiter: \nGO
            splitStatements: true
            sql: >-
              CREATE OR REPLACE TRIGGER update_orders_trigger
              AFTER INSERT
              ON delivery_order_rel
              FOR EACH ROW
              EXECUTE FUNCTION update_orders_trigger_function();

  -  changeSet:
       id: 27032024_46
       author: jdev
       changes:
         -  createTable:
              tableName: shopping_cart
              columns:
                - column:
                    constraints:
                      nullable: false
                      primaryKey: true
                      primaryKeyName: pk_shopping_cart_id
                    name: id
                    type: UUID
                    defaultValue: uuid_generate_v4()
                - column:
                    constraints:
                      nullable: false
                    name: user_uid
                    type: UUID
                    remarks: Keycloak user ID
                - column:
                    constraints:
                      nullable: false
                    name: restaurant_id
                    type: INTEGER
                    remarks: Restaurant ID
                - column:
                    constraints:
                      nullable: true
                    name: user_address_id
                    type: INTEGER
                    remarks: User address delivery
         - addUniqueConstraint:
             columnNames: restaurant_id, user_uid
             constraintName: shopping_cart_restaurant_id_user_uid_unique
             schemaName: public
             tableName: shopping_cart
             validate: true
         - addForeignKeyConstraint:
             baseColumnNames: restaurant_id
             baseTableName: shopping_cart
             constraintName: shopping_cart_restaurant_template_fkey
             referencedColumnNames: id
             referencedTableName: restaurant_template
             validate: true
         - addForeignKeyConstraint:
             baseColumnNames: user_address_id
             baseTableName: shopping_cart
             constraintName: shopping_cart_user_address_fkey
             referencedColumnNames: id
             referencedTableName: user_addresses
             validate: true

  -  changeSet:
       id: 27032024_47
       author: jdev
       changes:
         -  createTable:
              tableName: shopping_cart_line
              columns:
                - column:
                    constraints:
                      nullable: false
                      primaryKey: true
                      primaryKeyName: pk_shopping_car_line_id
                    name: id
                    type: UUID
                    defaultValue: uuid_generate_v4()
                - column:
                    constraints:
                      nullable: false
                    name: shopping_cart_id
                    type: UUID
                - column:
                    constraints:
                      nullable: false
                    name: product_tmpl_id
                    type: INTEGER
                    remarks: Product ID
                - column:
                    constraints:
                      nullable: true
                    name: qty
                    type: INTEGER
                    remarks: Quantity added
                - column:
                    name: attr_value_ids
                    type: int[]
                    remarks: List of Id`s attribute values
         - addForeignKeyConstraint:
             baseColumnNames: product_tmpl_id
             baseTableName: shopping_cart_line
             constraintName: shopping_cart_line_product_tmpl_id_fkey
             referencedColumnNames: id
             referencedTableName: product_template
         - addForeignKeyConstraint:
             baseColumnNames: shopping_cart_id
             baseTableName: shopping_cart_line
             constraintName: shopping_cart_line_shopping_cart_id_fkey
             referencedColumnNames: id
             referencedTableName: shopping_cart
  - changeSet:
      id: 27032024_48
      author: jdev
      changes:
        - addColumn:
            tableName: product_attribute
            columns:
              - column:
                  name: product_tmpl_id
                  type: INTEGER
                  remarks: Product Tmpl Rel
        - addForeignKeyConstraint:
            baseColumnNames: product_tmpl_id
            baseTableName: product_attribute
            constraintName: product_attribute_product_tmpl_id_fkey
            referencedColumnNames: id
            referencedTableName: product_template
  -  changeSet:
       id:  27032024_49
       author:  jdev
       changes:
         -  createView:
              encoding:  UTF-8
              replaceIfExists:  true
              schemaName:  public
              selectQuery:  select
                ptpavr.id ,
                ptpavr.product_tmpl_id,
                pav."name" as "name_attr_val" ,
                pav."sequence" as "sequence_attr_val",
                pa."name" as "name_attr",
                pa."sequence" as "sequence_attr",
                pav.default_extra_price,
                pa.display_type as display_type
                from
                product_template_product_attribute_value_rel ptpavr
                join product_attribute_value pav on ptpavr.product_attribute_value_id = pav.id
                join product_attribute pa on ptpavr.attribute_id = pa.id
                order by pa."sequence" , pav."sequence"
              viewName:  product_tmpl_attr_values

  - changeSet:
      id: 27032024_50
      author: jdev
      changes:
        - createSequence:
            cycle: false
            dataType: INTEGER
            startValue: 1
            incrementBy: 1
            minValue: 1
            maxValue: 2147483647
            schemaName: public
            sequenceName: mobile_delivery_zone_id_seq
        - createTable:
            tableName: mobile_delivery_zone
            columns:
              - column:
                  name: id
                  type: INTEGER
                  remarks: ID Unique, PK
                  defaultValueComputed: nextval('mobile_delivery_zone_id_seq')
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: pk_mobile_delivery_zone_id
              - column:
                  name: name
                  type: VARCHAR
                  remarks: Zone name
              - column:
                  name: has_minimum_amount
                  type: BOOL
                  remarks: Zone has minimum amount
                  constraints:
                    nullable: false
              - column:
                  name: minimum_amount
                  type: INTEGER
                  remarks: Order minimum amount in the zone
              - column:
                  name: active
                  type: BOOL
                  remarks: Active
                  constraints:
                    nullable: false
              - column:
                  name: area
                  type: GEOMETRY(POLYGON, 4326)
                  remarks: location area
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Created on
              - column:
                  name: updated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
                  remarks: Last Updated on
              - column:
                  name: create_uid
                  type: VARCHAR
                  remarks: Created by
              - column:
                  name: write_uid
                  type: VARCHAR
                  remarks: Last Updated by
  - changeSet:
      id: 27032024_51
      author: jdev
      changes:
        - sql:
            sql: >-
              CREATE INDEX idx_zones_geom ON mobile_delivery_zone USING GIST (area);